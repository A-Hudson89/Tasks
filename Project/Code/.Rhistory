View(my_mean)
View(my_mean)
View(my_mean)
nxt()
?vector
my_mean <- function(my_vector) {
sum(my_vector)/length(my_vector)
}
submit()
View(my_vector)
my_mean <- function(my_vector) {
sum(my_vector)/length(my_vector)
}
submit()
my_mean <- function(my_vector) {
sum(my_vector) / length(my_vector)
}
submit()
my_mean <- function(my_vector) {
# Write your code here!
# Remember: the last expression evaluated will be returned!
sum(my_vector)/length(my_vector)
}
submit()
my_mean <- function(my_vector) {
sum(my_vector)/length(my_vector)
}
submit()
View(my_mean)
?function
submit()
nxt()
?function
nxt()
nxt()
my_mean <- function(my_vector) {
sum(my_vector) / length(my_vector)
}
submit()
my_mean(c(4,5,10))
remainder <- function(num, divisor = 2) {
num %% divisor
}
submit()
remainder(5)
remainder(11, 5)
remainder( divisor = 11, num = 5)
remainder(4, div=2)
args(remainder)
evaluate <- function(func, dat){
func + dat
}
submit()
evaluate <- function(func, dat){
func(dat)
}
submit()
evaluate(c(1.4,3.6,7.9,8.8))
evaluate(standev, c(1.4,3.6,7.9,8.8))
evaluate(sd, c(1.4,3.6,7.9,8.8))
evaluate(function(x){x+1}, 6)
evaluate(function(x){x+1}, 7)
evaluate(function(x){x:1}, 7)
evaluate(function(x){x[1]}, c(8, 4, 0))
evaluate(function(x){x[3]}, c(8, 4, 0))
evaluate(function(x){x[length(x)]}, c(8, 4, 0))
?paste
paste("Programming", "is", "fun!")
telegram <- function(...){
paste("START", ..., "STOP")
}
submit()
telegram("hey","fucker")
mad_libs <- function(...){
args <- list(...)
place <- args[["place"]]
adjective <- args[["adjective"]]
noun <- args[["noun"]]
paste("News from", place, "today where", adjective, "students took to the streets in protest of the new", noun, "being installed on campus.")
}
submit()
mad_libs(adjective = "", place = "", noun = "")
"%p%" <- function(left, right){
paste(left, right)
}
submit()
"I" %p% "love" %p% "R!"
data(cars)
?cars
head(cars)
plot(cars)
?plot
plot(x = cars$speed, y = cars$dist)
plot(x = cars$dist, y = cars$speed)
plot(x = cars$dist, y = cars$speed)
plot(x = cars$speed, y = cars$dist)
plot(x = cars$speed, y = cars$dist, xlab = speed)
plot(x = cars$speed, y = cars$dist, xlab = "Speed")
plot(x = cars$speed, y = cars$dist, xlab = "Speed", ylab = "Stopping Distance")
plot(x = cars$speed, y = cars$dist, ylab = "Stopping Distance")
plot(x = cars$speed, y = cars$dist, xlab = "Speed", ylab = "Stopping Distance")
plot(cars, title = "My Plot")
plot(cars, main = "My Plot")
plot(cars, sub = "My Plot Subtitle")
plot(cars, col = 2)
plot(cars, xlim = c(10,15))
?points
plot(cars, pch = 2)
mtcars
data(mtcars)
?boxplot
boxplot(formula = mpg ~ cyl, data = mtcars)
hist(mtcars$mpg)
trueMean1 <- 5
trueSD1 <- 5
population1 <- rnorm(1e6, trueMean1, trueSD1)
trueMean2 <- 4
trueSD2 <- 5
population2 <- rnorm(1e6, trueMean2)
sample1 <- sample(population1, size)
sample2 <- sample(population2, size)
size <- 50
sample1 <- sample(population1, size)
sample2 <- sample(population2, size)
sample1
sample2
population1
population2
source("http://jonsmitchell.com/code/simFxn04.R")
MatGrandma <- makeFounder("grandma_mom")
MatGrandpa <- makeFounder("grandpa_mom")
PatGrandma <- makeFounder("grandma_dad")
PatGrandpa <- makeFounder("grandpa_dad")
head(MatGrandma)
head(MatGrandpa)
nrow(MatGrandma)
head(PatGrandma)
rrow(PatGrandma)
nrow(PatGrandma)
Alan <- makeBaby(PatGrandma, PatGrandpa)
Brenda <- makeBaby(MatGrandma, MatGrandpa)
Focus <- makeBaby(Brenda, Alan)
ToMom <- length(grep("mom", Focus))/length(Focus)
ToMom
ToMomMom <- length(grep("grandma_mom", Focus))/length(Focus)
ToMomDad <- length(grep("grandpa_mom", Focus))/length(Focus)
ToMomMom
ToMomDad
ToMomMom == ToMomDad
ToDadDad <- length(grep("grandma_dad", Focus))/length(Focus)
ToDadMom <- length(grep("grandpa_dad", Focus))/length(Focus)
ToDadDad == ToDadMom
AvgRelateTotal <- length(grep("grandma_mom", "grandpa_mom", "grandma_dad", "grandpa_dad", Focus))/length(Focus)
AvgRelateTotal
head(AvgRelateTotal)
Sibling_01 <- makeBaby(Brenda, Alan)
ToSib <- length(intersect(Focus, Sibling_01))/length(Focus)
ToSib
ManySiblings <- replicate(1e3, length(intersect(Focus, makeBaby(Brenda, Alan)))length(Focus))
ManySiblings <- replicate(1e3, length(intersect(Focus, makeBaby(Brenda, Alan)))/length(Focus))
ManySiblings
quantile(ManySiblings)
mean(ManySiblings)
plot(density(ManySiblings), main = "", xlab = "proportion shared genes")
HWE <- function(p) {
aa <- p^2
ab <- 2 * p * (1-p)
bb <- (1-p)^2
return(c(aa=aa, ab=ab, bb=bb))
}
HWE(0.5)
plot(1, 1, type="n", xlim=c(0,1), ylim=c(0,1), xlab="freq. allele a", ylab="geno. freq")
p <- seq(from = 0, to = 1, by = 0.01)
GenoFreq <- t(sapply(p,HWE))
lines(p, GenoFreq[,"aa"], lwd=2, col="red")
lines(p, GenoFreq[,"ab"], lwd=2, col="purple")
lines(p, GenoFreq[,"bb"], lwd=2, col="blue")
legend("top", legend=c("aa","ab","bb") col=c("red","purple","blue"), lty=1, lwd=2, bty="n")
legend("top", legend=c("aa","ab","bb"), col=c("red","purple","blue"), lty=1, lwd=2, bty="n")
Pop <- simPop(500)
points(Pop[,"freqa"], Pop[,"Genotypes.aa"]/500, pch=21, bg="red")
Pop <- simPop(50)
points(Pop[,"freqa"], Pop[,"Genotypes.aa"]/50, pch=22, bg="red")
library(learnPopGen)
instal.packages("learnPopGen")
library(learnPopGen)
install.packages("learnPopGen")
library(learnPopGen)
library(learnPopGen)
learnPopGen()
x <- genetic.drift(Ne=200, nrep=5, pause=0.01)
x <- genetic.drift(Ne=200, nrep=5, pause=0.01)
x <- genetic.drift(Ne=200, nrep=5, pause=0.01)
x <- genetic.drift(Ne=20, nrep=5, pause=0.01)
x <- genetic.drift(Ne=2000, nrep=5, pause=0.01)
PopSizes <- 5:50
Samples <- rep(PopSizes, 5)
tExt <- sapply(samples, function(x) nrow(simPop(x,500)))
PopSizes <- 5:50
Samples <- rep(PopSizes, 5)
tExt <- sapply(Samples, function(x) nrow(simPop(x,500)))
Line <- lm(tExt ~ Samples)
summary(Line)
summary(Line)
summary(Line)
PopSizes <- 5:50
Samples <- rep(PopSizes, 5)
tExt <- sapply(Samples, function(x) nrow(simPop(x,500)))
Line <- lm(tExt ~ Samples)
tExt
Line$coef
plot(Samples, tExt)
abline(Line)
Line2 <- lm(tExt ~ Samples + 0)
abline(Line2)
Line2$coef
Line$coef
plot(Samples, tExt)
abline(Line)
abline(Line2)
Line2 <- lm(tExt ~ Samples + 0)
Line2$coef
plot(Samples, tExt)
abline(Line2)
abline(Line)
Line2 <- lm(tExt ~ Samples + 0)
Line2$coef
plot(Samples, tExt)
abline(Line2)
Line <- rlm(tExt ~ Samples)
Line2 <- rlm(tExt ~ Samples + 0)
install.packages(MASS)
library(MASS)
install.packages("MASS")
install.packages("MASS")
install.packages("MASS")
library(MASS)
Line <- rlm(tExt ~ Samples)
Line2 <- rlm(tExt ~ Samples + 0)
plot(Samples, tExt)
abline(Line)
abline(Line2)
?rlm
simulate(tExt)
library(lmtest)
install.packages("lmtest")
library(lmtest)
Line <- lm(tExt ~ Samples)
bptest(Line)
Line %>%
vcovHC() %>%
diag() %>%
sqrt()
install.packages("sandwich")
library(sandwich)
Line <- rlm(tExt ~ Samples)
bptest(Line)
bptest(Line2)
Line2 <- rlm(tExt ~ Samples + 0)
bptest(Line2)
Line <- wlm(tExt ~ Samples)
Line <- wlm(tExt ~ Samples, data = tExt, weights = 1/sd_variance)
Line <- rlm(tExt ~ Samples, data = tExt, weights = 1/sd_variance)
Line <- rlm(tExt ~ Samples, weights = 1/sd_variance)
wt <- 1 / lm(abs(model$residuals) ~ model$fitted.values)$fitted.values^2
wt <- 1 / lm(abs(Line$residuals) ~ Line$fitted.values)$fitted.values^2
wlm_Line <- lm(tExt ~ Samples, data = df, weights=wt)
wlm_Line <- lm(tExt ~ Samples, List = df, weights=wt)
wlm_Line <- lm(tExt ~ Samples, weights=wt)
plot(Samples, tExt)
wlm_Line <- lm(tExt ~ Samples, weights=wt)
wlm_Line
Line$coef
Line <- lm(tExt ~ Samples)
Line
plot(Samples, tExt)
Line <- lm(tExt ~ Samples)
abline(Line)
LineA <- rlm(tExt ~ Samples)
abline(LineA)
LineA$coef
summary(LineA)
summary(Line)
bptest(LineA)
source("http:jonsmitchell.com/comde/fxn05.R")
source("http://jonsmitchell.com/comde/fxn05.R")
source("http://jonsmitchell.com/code/fxn05.R")
Pop1 <- simPop(Popsize = 50, nGenerations = 100, initial_p = 0.5, h = 1, s = 0)
plot(1:nrow(Pop1), Pop1[,1], ylim=c(0,1), type = "1", xlab="generation", ylab="allele freq.", lwd=2)
plot(1 : nrow(Pop1), Pop1[,1], ylim = c(0,1), type = "1", xlab = "generation", ylab = "allele freq.", lwd=2)
plot(1 : nrow(Pop1), Pop1[,1], ylim = c(0,1), type = "l", xlab = "generation", ylab = "allele freq.", lwd=2)
lines(1:nrow(Pop1), Pop1[,2], lwd=2, col="red")
legend("topleft", legend = c("a", "b"), col = c("black", "red"), ldw = 2, bty="n")
legend("topleft", legend = c("a", "b"), col = c("black", "red"), lwd = 2, bty="n")
plotFit(nruns = 10, n = 50, ngens = 100, init_p = 0.5, h =1, s = 0)
Expectation <- c(10,10,10,10)
Observed <- c(15,15,5,5)
chisq <- sum(((Expectation - Observed)^2)/Expectation)
chisq
Expectation <- c(10,10,10,10)
Observed <- c(5,0,0,35)
chisq <- sum(((Expectation - Observed)^2)/Expectation)
chisq
Expectation <- c(10,10,10,10)
Observed <- c(2,3,10,30)
chisq <- sum(((Expectation - Observed)^2)/Expectation)
chisq
Expectation <- c(10,10,10,10)
Observed <- c(9,7,11,12)
chisq <- sum(((Expectation - Observed)^2)/Expectation)
chisq
Expectation <- c(10,10,10,10)
Observed <- c(10,10,10,10)
chisq <- sum(((Expectation - Observed)^2)/Expectation)
chisq
results<- read.csv("http://jonsmitchell.com/data/biol112labresults.csv", stringsAsFactors = F)
setwd('C:\\Desktop\\Evolution\\Tasks\\Task_04")
results<- read.csv("http://jonsmitchell.com/data/biol112labresults.csv", stringsAsFactors = F)
length(results)
s
setwd('C:\\Desktop\\Evolution\\Tasks\\Task_04")
results<- read.csv("http://jonsmitchell.com/data/biol112labresults.csv", stringsAsFactors = F)
length
length(results)
nrow(results)
ncol(results)
colnames(results)
head(results)
counts <- results[,c("yellow","red","green","blue","black","tan")]
backgrounds <- c("White", "Red", "Yellow", "Green", "Blue", "Black")
backgroundCol <- c("white", "#d53e4f", "#fee08b", "#abdda4", "#3288bd", "black")
calcChi(counts[1,])
Chisq <- apply(counts, 1, calcChi)
plotChis(counts)
Chisqs <- apply(counts, 1, calcChi)
plotChis(counts)
Avg <- mean(Chisqs)
Avg
backgroundAvgs <- tapply(Chisqs, results[,3], mean)
backgroundsAvgs
backgroundAvgs
propSig <- length(which(Chisqs > 11.70))/length(Chisqs)
percSig <- round(100 * propSig)
propSig
percSig
setwd("C:\\Desktop\\Evolution\\Tasks\\Task_04")
setwd("C:\\Users\\abh00\\OneDrive\\Desktop\\Evolution\\Tasks\\Task_08")
text.string <-
"(((((((cow, pig), whale), (bat, (lemur, human))),(robin, iguana)), coelacanth),
(gold_fish, trout)), shark);"
vert.tree <- read.tree(text=text.string)
plot(vert.tree,edge.width=2)
library(ape)
vert.tree <- read.tree(text=text.string)
plot(vert.tree,edge.width=2)
nodelabels(frame= "circle", bg= 'white', cex= 1)
vert.tree
str(vert.tree)
tree <- read.tee(text= "(((A,B), (C,D)), E);")
tree <- read.tree(text= "(((A,B), (C,D)), E);")
plotTree(tree, offset=1)
tiplabels(frame="circle", bg='lightblue', cex=1)
nodelabels(frame="circle", bg='white', cex=1)
library(phytools)
tree <- read.tree(text= "(((A,B), (C,D)), E);")
plotTree(tree, offset=1)
tiplabels(frame="circle", bg='lightblue', cex=1)
nodelabels(frame="circle", bg='white', cex=1)
tree$tip.label
tree$edge
AnolisTree <- force.ultrametric(read.tree("https://jonsmitchell.com/data/anolis.tre"))
hist(AnolisTree$edge.length, col='black', border='white', main="",
xlab="edge lengths for the anolis tree", ylim=c(0,50), xlim=c(0,6))
hist(AnolisTree$edge.length, col='black', border='white', main="", xlab="edge lengths for the anolis tree", ylim=c(0,50), xlim=c(0,6))
par(las=1)
hist(AnolisTree$edge.length, col= 'black', border= 'white', main= "", xlab= "edge lengths for the anolis tree", ylim= c(0, 50), xlim= c(0, 6))
par(las=1)
hist(AnolisTree$edge.length, col= 'black', border= 'white', main= "", xlab= "edge lengths for the anolis tree", ylim= c(0, 50), xlim= c(0, 6))
tipEdges <- which(AnolisTree$edge[,2] <= Ntip(AnolisTree))
Lengths <- AnolisTree$edge.length
names(Lengths) <- AnolisTre$tip.label
names(Lengths)[which(Lengths= min(Lengths))]
par(las=1)
hist(AnolisTree$edge.length, col= 'black', border= 'white', main= "", xlab= "edge lengths for the anolis tree", ylim= c(0, 50), xlim= c(0, 6))
tipEdges <- which(AnolisTree$edge[,2] <= Ntip(AnolisTree))
Lengths <- AnolisTree$edge.length
names(Lengths) <- AnolisTree$tip.label
names(Lengths)[which(Lengths= min(Lengths))]
names(Lengths)[which(Lengths == min(Lengths))]
plot(AnolisTree, cex=0.25)
Labs <- sapply(AnolisTree$edge.length, round, digits=2)
edgelabels(text=Labs, cex=0.25)
?plot.phylo
plot(AnolisTree, cex=0.25, show.tip.label= FALSE)
Labs <- sapply(AnolisTree$edge.length, round, digits=2)
edgelabels(text=Labs, cex=0.25)
plot(AnolisTree, type= "radial", cex=0.25, show.tip.label= FALSE)
plot(AnolisTree, type= "radial", cex=0.25, show.tip.label= FALSE, tip.color= 'red')
plot(AnolisTree, type= "radial", cex=0.25, show.tip.label= FALSE, tip.color= "red")
plot(AnolisTree, type= "radial", cex=0.25, tip.color= "red")
?which
plot(Anolistree, cex=0.25, which.min(Anolistree))
plot(Anolistree, cex=0.25, which.min(x))
setwd("C:\\Users\\abh00\\OneDrive\\Desktop\\Evolution\\Tasks\\Task_08")
AnolisTree <- force.ultrametric(read.tree("https://jonsmitchell.com/data/anolis.tre"))
par(las=1)
hist(AnolisTree$edge.length, col= 'black', border= 'white', main= "", xlab= "edge lengths for the anolis tree", ylim= c(0, 50), xlim= c(0, 6))
tipEdges <- which(AnolisTree$edge[,2] <= Ntip(AnolisTree))
Lengths <- AnolisTree$edge.length
names(Lengths) <- AnolisTree$tip.label
names(Lengths)[which(Lengths == min(Lengths))]
plot(AnolisTree, cex=0.25)
Labs <- sapply(AnolisTree$edge.length, round, digits=2)
edgelabels(text=Labs, cex=0.25)
plot(Anolistree, cex=0.25, which.min(x))
plot(AnolisTree, cex=0.25, which.min(x))
plot(AnolisTree, cex=0.25, which.min)
plot(AnolisTree, type= "phylogram", cex=0.25, which.min)
plot(AnolisTree, cex=0.25)
Labs <- sapply(AnolisTree$edge.length, round, digits=2)
edgelabels(text=Labs, cex=0.25)
plot(AnolisTree, cex=0.25)
Labs <- sapply(AnolisTree$min.length, round, digits=2)
edgelabels(text=Labs, cex=0.25)
Which.min(AnolisTree$edge.length)
?which.min
library(base64enc)
Which.min(AnolisTree$edge.length)
detach("package:base64enc", unload = TRUE)
install.packages("base")
library(base)
Which.min(AnolisTree$edge.length)
install.packages("base")
install.packages("base")
which.min(AnolisTree$edge.length)
AnolisTree2 <- drop.tip(AnolisTree, 82)
library(ape)
library(phytools)
AnolisTree2 <- drop.tip(AnolisTree, 82)
plot(AnolisTree2, cex=0.25)
?fit.bd
abline(0,1,lwd=2,col='red',lty=2)
ltt(AnolisTree)
abline(0,1,lwd=2,col='red',lty=2)
?fit.bd
bd.fitAnolis <- fit.bd(AnolisTree, rho=0.2)
print(bd.fitAnolis)
install.packages("phylotastic")
install.packages("rphylotastic")
library(treebase)
?treebase
install.packages("treeBase")
dolphins <- search_treebase('"Delphinus"', by="taxon", max_trees=5)
dolphins <- search_treebase('"Delphinus"', by="taxon", max_trees=1)
?search_treebase
dolphins <- search_treebase('"Delphinus"', by="taxon", max_trees=1, branch_lengths=TRUE)
dolphins <- search_treebase('"Delphinus"', by="taxon", max_trees=1, branch_lengths=TRUE, exact_match=TRUE)
install.packages("diversitree")
library(diversitree)
?diversitree
install.packages("rvertnet")
library(rvertnet)
?rvertnet
searchbyterm(class="Aves")
install.packages("genbankr")
install.packages("phylotastic")
install.packages("rphylotastic")
?force.ultrametric
PrimateTree <- force.ultrametric(read.nexus("C:\\Users\\abh00\\OneDrive\\Desktop\\Evolution\\Tasks\\Extra credit"))
par(las=1)
PrimateTree <- read.nexus("C:\\Users\\abh00\\OneDrive\\Desktop\\Evolution\\Tasks\\Extra credit")
par(las=1)
PrimateTree <- write.nexus("C:\\Users\\abh00\\OneDrive\\Desktop\\Evolution\\Tasks\\Extra credit")
par(las=1)
PrimateTree
setwd("C:\\Users\\abh00\\OneDrive\\Desktop\\Evolution\\Tasks\\Extra credit")
PrimateTree <- read.nexus("TreeBlock_10kTrees_Primates_Version3.nex")
par(las=1)
PrimateTree
plot(PrimateTree, cex=0.25)
LemurTree <- read.nexus("TreeBlock_10kTrees_Lemurs_Version3.nex")
par(las=1)
plot(LemurTree, cex=0.25)
bd.fitAnolis <- fit.bd(LemurTree, rho=0.2)
print(bd.fitAnolis)
bd.fitLemur <- fit.bd(LemurTree, rho=0.2)
print(bd.fitLemurTree)
bd.fitLemurTree <- fit.bd(LemurTree, rho=0.2)
print(bd.fitLemurTree)
bd.fitLemurTree <- fit.bd(LemurTree, rho=0.2)
LemurTree <- force.ultrametric(read.nexus("TreeBlock_10kTrees_Lemurs_Version3.nex"))
par(las=1)
LemurTree <- read.nexus("TreeBlock_10kTrees_Lemurs_Version3.nex")
par(las=1)
which(LemurTree[0,1])
which(LemurTree[,1])
which(LemurTree$1)
LemurTree
head(LemurTree)
LemurTree[0:1]
LemurTree1 <- LemurTree[0:1]
LemurTree1
plot(LemurTree1, cex=0.25)
bd.fitLemurTree1 <- fit.bd(LemurTree1, rho=0.2)
print(bd.fitLemurTree1)
bd.fitLemurTree1 <- fit.bd(LemurTree1, rho=0.2)
print(force.ultrametric(bd.fitLemurTree1))
bd.fitLemurTree1 <- fit.bd(LemurTree1, rho=0.2)
bd.fitLemurTree1 <- (force.ultrametric(fit.bd(LemurTree1, rho=0.2)))
bd.fitLemurTree1 <- force.ultrametric(fit.bd(LemurTree1, rho=0.2))
setwd("C:\\Users\\abh00\\OneDrive\\Desktop\\Evolution\\Tasks\\Task_08")
setwd("C:\\Users\\abh00\\OneDrive\\Desktop\\Evolution\\Tasks\\Project\\Code")
